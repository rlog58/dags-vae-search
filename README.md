# dag-embedded-search

Run tests:
```shell
pytest tests
```


RU:

# Поиск структуры байесовских сетей (BNSL)

Рассмотрим задачу поиска структуры байесовских сетей с дискретными переменными. 

Ниже представлен список классических сетей с указанием числа вершин n и числа ребер n.

Источник - [bnlearn](https://www.bnlearn.com/bnrepository/).

Малые сети:
 1. asia (n=8, e=8)
 2. cancer (n=5, e=4)
 3. earthquake (n=5, e=4)
 4. sachs (n=11, e=17)
 5. survey (n=6, e=6)

Средние сети:
 1. alarm (n=37, e=46)
 2. barley (n=48, e=84)
 3. child (n=20, e=25)
 4. insurance (n=27, e=52)
 5. mildew (n=35, e=46)
 6. water (n=32, e=66)

Большие сети:
 1. hailfinder (n=56, e=66)
 2. hepar2 (n=70, e=123)
 3. win95pts (n=76, e=112)

Очень большие сети:
 1. andes (n=223, e=338)
 2. diabetes (n=413, e=602)
 3. link (n=724, e=1125)
 4. pathfinder (n=109, e=195)
 5. pigs (n=441, e=592)

Замечания:
 - Сети в основно разряженные - в среднем 0.167
 - Самая разряженная сеть - link (0.0043)
 - Самая плотная сеть - cancer, earthquake (0.571)

Делать глобальные выводы по структуре сетей на основе данных примеров нельзя, однако можно сделать предположение о разряженности сетей.

Сделаем предположение о разряженности сетей для сужения пространства поиска:
 - Очень малые сети n<10 (<=0.6)
 - Малые сети n<20 (<=0.4)
 - Средние сети n<50 (<=0.2)
 - Большие сети n<100 (<=0.1)
 - Очень большие сети n>=100 (<=0.05)

## Кодирование
Байесовская сеть представляется как DAG со значениями в вершинах - переменная (или её индекс в списке переменных). 

Например, рассмотрим сеть cancer c переменными:
1. Pollution 
2. Smoker 
3. Cancer 
4. Xray 
5. Dyspnoea

Заранее мы не знаем как зависят между собой переменные или какой топологический порядок в сети.

```
# целевой граф
# BIC - 

1 -> 3
2 -> 3
3 -> 4
4 -> 5
```

Поиск будет производиться путем минимизации метрики BIC вычисленной для данной структуры. 



